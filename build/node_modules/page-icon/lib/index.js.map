{"version":3,"sources":["../src/index.js"],"names":[],"mappings":";;;;AAEA,IAAM,MAAM,QAAQ,KAAR,CAAN;AACN,IAAM,UAAU,QAAQ,mBAAR,CAAV;AACN,IAAM,eAAe,QAAQ,wBAAR,CAAf;AACN,IAAM,gBAAgB,QAAQ,kCAAR,CAAhB;AACN,IAAM,eAAe,QAAQ,wBAAR,CAAf;;AAEN,SAAS,OAAT,CAAiB,OAAjB,EAA0B;AACtB,WAAO,IAAI,KAAJ,CAAU,OAAV,EAAmB,QAAnB,KAAgC,QAAhC,CADe;CAA1B;;AAIA,SAAS,SAAT,CAAmB,OAAnB,EAA4B;AACxB,QAAM,SAAS,IAAI,KAAJ,CAAU,OAAV,CAAT,CADkB;AAExB,WAAO,QAAP,GAAkB,QAAlB,CAFwB;AAGxB,WAAO,IAAI,MAAJ,CAAW,MAAX,CAAP,CAHwB;CAA5B;;AAMA,SAAS,IAAT,CAAc,OAAd,EAAmC;QAAZ,gEAAQ,kBAAI;;;AAE/B,QAAM,eAAe,SAAf,YAAe,CAAS,KAAT,EAAgB;AAC/B,eAAO,aAAa,KAAb,EAAoB,QAAQ,GAAR,CAA3B,CAD+B;KAAhB,CAFU;;AAM/B,WAAO,QAAQ,OAAR,EACF,IADE,CACG,UAAU,GAAV,EAAe;AACjB,eAAO,aAAa,OAAb,EAAsB,GAAtB,CAAP,CADiB;KAAf,CADH,CAIF,IAJE,CAIG,aAJH,EAKF,IALE,CAKG,YALH,EAMF,IANE,CAMG,kBAAU;AACZ,YAAI,UAAU,QAAQ,OAAR,CAAV,EAA4B;AAC5B,mBAAO,MAAP,CAD4B;SAAhC;;AAIA,YAAM,WAAW,UAAU,OAAV,CAAX,CALM;AAMZ,eAAO,KAAK,QAAL,EAAe,OAAf,CAAP,CANY;KAAV,CANV,CAN+B;CAAnC;;AAsBA,OAAO,OAAP,GAAiB,IAAjB","file":"index.js","sourcesContent":["import 'source-map-support/register';\n\nconst url = require('url');\nconst getPage = require('./modules/getPage');\nconst getIconLinks = require('./modules/getIconLinks');\nconst downloadIcons = require('./modules/download/downloadIcons');\nconst findBestIcon = require('./modules/findBestIcon');\n\nfunction isHttps(pageUrl) {\n    return url.parse(pageUrl).protocol === 'https:';\n}\n\nfunction makeHttps(pageUrl) {\n    const parsed = url.parse(pageUrl);\n    parsed.protocol = 'https:';\n    return url.format(parsed);\n}\n\nfunction main(pageUrl, options={}) {\n\n    const bestWithPref = function(icons) {\n          return findBestIcon(icons, options.ext);\n    };\n\n    return getPage(pageUrl)\n        .then(function (dom) {\n            return getIconLinks(pageUrl, dom);\n        })\n        .then(downloadIcons)\n        .then(bestWithPref)\n        .then(result => {\n            if (result || isHttps(pageUrl)) {\n                return result;\n            }\n\n            const httpsUrl = makeHttps(pageUrl);\n            return main(httpsUrl, options);\n        });\n}\n\nmodule.exports = main;\n"]}