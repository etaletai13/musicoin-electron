{"version":3,"sources":["../../src/modules/getIconLinks.js"],"names":[],"mappings":";;AAAA,IAAM,UAAU,QAAQ,SAAR,CAAV;AACN,IAAM,MAAM,QAAQ,KAAR,CAAN;;AAEN,SAAS,UAAT,CAAoB,IAApB,EAA0B;AACtB,WAAO,oCAAmC,IAAnC,CAAwC,IAAxC,CAAP;MADsB;CAA1B;;AAIA,SAAS,YAAT,CAAsB,OAAtB,EAA+B;AAC3B,QAAM,YAAY,IAAI,KAAJ,CAAU,OAAV,CAAZ,CADqB;AAE3B,cAAU,QAAV,GAAqB,IAArB,CAF2B;AAG3B,WAAO,UAAU,MAAV,EAAP,CAH2B;CAA/B;;AAMA,SAAS,YAAT,CAAsB,CAAtB,EAAyB;AACrB,QAAM,QAAQ,EAAR,CADe;AAErB,MAAE,MAAF,EAAU,IAAV,CAAe,UAAS,KAAT,EAAgB,OAAhB,EAAyB;AACpC,YAAM,OAAO,EAAE,OAAF,EAAW,IAAX,CAAgB,MAAhB,CAAP,CAD8B;AAEpC,YAAI,CAAC,WAAW,IAAX,CAAD,EAAmB;AACnB,mBADmB;SAAvB;AAGA,cAAM,IAAN,CAAW,IAAX,EALoC;KAAzB,CAAf,CAFqB;AASrB,WAAO,KAAP,CATqB;CAAzB;;AAYA,SAAS,YAAT,CAAsB,CAAtB,EAAyB;AACrB,QAAM,QAAQ,EAAR,CADe;AAErB,MAAE,MAAF,EAAU,IAAV,CAAe,UAAC,KAAD,EAAQ,OAAR,EAAoB;AAC/B,YAAM,WAAW,EAAE,OAAF,EAAW,IAAX,CAAgB,UAAhB,CAAX,CADyB;AAE/B,YAAI,aAAa,UAAb,EAAyB;AACzB,mBADyB;SAA7B;;AAIA,YAAM,gBAAgB,EAAE,OAAF,EAAW,IAAX,CAAgB,SAAhB,CAAhB,CANyB;AAO/B,cAAM,IAAN,CAAW,aAAX,EAP+B;KAApB,CAAf,CAFqB;;AAYrB,WAAO,KAAP,CAZqB;CAAzB;;AAeA,SAAS,YAAT,CAAsB,OAAtB,EAA+B,GAA/B,EAAoC;AAChC,QAAI,IAAI,QAAQ,IAAR,CAAa,GAAb,CAAJ,CAD4B;AAEhC,QAAI,YAAY,EAAZ,CAF4B;;AAIhC,gBAAY,UAAU,MAAV,CAAiB,aAAa,CAAb,CAAjB,CAAZ,CAJgC;AAKhC,gBAAY,UAAU,MAAV,CAAiB,aAAa,CAAb,CAAjB,CAAZ,CALgC;;AAOhC,gBAAY,UAAU,GAAV,CAAc,oBAAY;AAClC,eAAO,IAAI,OAAJ,CAAY,OAAZ,EAAqB,QAArB,CAAP,CADkC;KAAZ,CAA1B,CAPgC;;AAWhC,cAAU,IAAV,CAAe,IAAI,OAAJ,CAAY,aAAa,OAAb,CAAZ,EAAmC,sBAAnC,CAAf,EAXgC;AAYhC,WAAO,SAAP,CAZgC;CAApC;;AAeA,OAAO,OAAP,GAAiB,YAAjB","file":"getIconLinks.js","sourcesContent":["const cheerio = require('cheerio');\nconst url = require('url');\n\nfunction hrefIsIcon(href) {\n    return /((icon.*\\.(png|jpg))|(\\w+\\.ico))/.test(href);\n}\n\nfunction getDomainUrl(someUrl) {\n    const parsedUrl = url.parse(someUrl);\n    parsedUrl.pathname = null;\n    return parsedUrl.format()\n}\n\nfunction linkTagLinks($) {\n    const links = [];\n    $('link').each(function(index, element) {\n        const href = $(element).attr('href');\n        if (!hrefIsIcon(href)) {\n            return;\n        }\n        links.push(href);\n    });\n    return links;\n}\n\nfunction metaTagLinks($) {\n    const links = [];\n    $('meta').each((index, element) => {\n        const property = $(element).attr('property');\n        if (property !== 'og:image') {\n            return;\n        }\n\n        const graphImageUrl = $(element).attr('content');\n        links.push(graphImageUrl);\n    });\n\n    return links\n}\n\nfunction getIconLinks(rootUrl, dom) {\n    var $ = cheerio.load(dom);\n    let iconLinks = [];\n\n    iconLinks = iconLinks.concat(linkTagLinks($));\n    iconLinks = iconLinks.concat(metaTagLinks($));\n\n    iconLinks = iconLinks.map(iconLink => {\n        return url.resolve(rootUrl, iconLink);\n    });\n\n    iconLinks.push(url.resolve(getDomainUrl(rootUrl), 'apple-touch-icon.png'));\n    return iconLinks;\n}\n\nmodule.exports = getIconLinks;\n"]}