{"version":3,"sources":["helpers/helpers.js"],"names":["isOSX","os","platform","isWindows","downloadFile","fileUrl","axios","get","responseType","then","response","data","ext","path","extname","allowedIconFormats","hasIdentify","hasBinary","sync","hasConvert","hasIconUtil","pngToIcns","pngToIco","icoToIcns","icoToPng","icnsToPng","icnsToIco","formats","push","Error"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,SAASA,KAAT,GAAiB;AACf,SAAOC,aAAGC,QAAH,OAAkB,QAAzB;AACD;;AAED,SAASC,SAAT,GAAqB;AACnB,SAAOF,aAAGC,QAAH,OAAkB,OAAzB;AACD;;AAED,SAASE,YAAT,CAAsBC,OAAtB,EAA+B;AAC7B,SAAOC,gBACJC,GADI,CACAF,OADA,EACS;AACZG,kBAAc;AADF,GADT,EAIJC,IAJI,CAIC,UAACC,QAAD,EAAc;AAClB,QAAI,CAACA,SAASC,IAAd,EAAoB;AAClB,aAAO,IAAP;AACD;AACD,WAAO;AACLA,YAAMD,SAASC,IADV;AAELC,WAAKC,eAAKC,OAAL,CAAaT,OAAb;AAFA,KAAP;AAID,GAZI,CAAP;AAaD;;AAED,SAASU,kBAAT,CAA4Bb,QAA5B,EAAsC;AACpC,MAAMc,cAAcC,iBAAUC,IAAV,CAAe,UAAf,CAApB;AACA,MAAMC,aAAaF,iBAAUC,IAAV,CAAe,SAAf,CAAnB;AACA,MAAME,cAAcH,iBAAUC,IAAV,CAAe,UAAf,CAApB;;AAEA,MAAMG,YAAYF,cAAcC,WAAhC;AACA,MAAME,WAAWH,UAAjB;AACA,MAAMI,YAAYF,aAAaL,WAA/B;AACA,MAAMQ,WAAWL,UAAjB;;AAEA;AACA,MAAMM,YAAY,KAAlB;AACA,MAAMC,YAAY,KAAlB;;AAEA,MAAMC,UAAU,EAAhB;;AAEA;AACA,MAAIxB,WAAJ,EAAiB;AACf,YAAQD,QAAR;AACE,WAAK,QAAL;AACEyB,gBAAQC,IAAR,CAAa,OAAb;AACA;AACF,WAAK,OAAL;AACED,gBAAQC,IAAR,CAAa,MAAb;AACA;AACF,WAAK,OAAL;AACED,gBAAQC,IAAR,CAAa,MAAb;AACA;AACF;AACE,cAAM,IAAIC,KAAJ,CACH,uDAAsD3B,QAAS,EAD5D,CAAN;AAXJ;AAeA,WAAOyB,OAAP;AACD;;AAED,UAAQzB,QAAR;AACE,SAAK,QAAL;AACEyB,cAAQC,IAAR,CAAa,OAAb;AACA,UAAIP,SAAJ,EAAe;AACbM,gBAAQC,IAAR,CAAa,MAAb;AACD;AACD,UAAIL,SAAJ,EAAe;AACbI,gBAAQC,IAAR,CAAa,MAAb;AACD;AACD;AACF,SAAK,OAAL;AACED,cAAQC,IAAR,CAAa,MAAb;AACA,UAAIJ,QAAJ,EAAc;AACZG,gBAAQC,IAAR,CAAa,MAAb;AACD;AACD,UAAIH,SAAJ,EAAe;AACbE,gBAAQC,IAAR,CAAa,OAAb;AACD;AACD;AACF,SAAK,OAAL;AACED,cAAQC,IAAR,CAAa,MAAb;AACA,UAAIN,QAAJ,EAAc;AACZK,gBAAQC,IAAR,CAAa,MAAb;AACD;AACD,UAAIF,SAAJ,EAAe;AACbC,gBAAQC,IAAR,CAAa,OAAb;AACD;AACD;AACF;AACE,YAAM,IAAIC,KAAJ,CACH,uDAAsD3B,QAAS,EAD5D,CAAN;AA7BJ;AAiCA,SAAOyB,OAAP;AACD;;kBAEc;AACb3B,OADa;AAEbG,WAFa;AAGbC,cAHa;AAIbW;AAJa,C","file":"helpers.js","sourcesContent":["import os from 'os';\nimport axios from 'axios';\nimport hasBinary from 'hasbin';\nimport path from 'path';\n\nfunction isOSX() {\n  return os.platform() === 'darwin';\n}\n\nfunction isWindows() {\n  return os.platform() === 'win32';\n}\n\nfunction downloadFile(fileUrl) {\n  return axios\n    .get(fileUrl, {\n      responseType: 'arraybuffer',\n    })\n    .then((response) => {\n      if (!response.data) {\n        return null;\n      }\n      return {\n        data: response.data,\n        ext: path.extname(fileUrl),\n      };\n    });\n}\n\nfunction allowedIconFormats(platform) {\n  const hasIdentify = hasBinary.sync('identify');\n  const hasConvert = hasBinary.sync('convert');\n  const hasIconUtil = hasBinary.sync('iconutil');\n\n  const pngToIcns = hasConvert && hasIconUtil;\n  const pngToIco = hasConvert;\n  const icoToIcns = pngToIcns && hasIdentify;\n  const icoToPng = hasConvert;\n\n  // todo scripts for the following\n  const icnsToPng = false;\n  const icnsToIco = false;\n\n  const formats = [];\n\n  // todo shell scripting is not supported on windows, temporary override\n  if (isWindows()) {\n    switch (platform) {\n      case 'darwin':\n        formats.push('.icns');\n        break;\n      case 'linux':\n        formats.push('.png');\n        break;\n      case 'win32':\n        formats.push('.ico');\n        break;\n      default:\n        throw new Error(\n          `function allowedIconFormats error: Unknown platform ${platform}`,\n        );\n    }\n    return formats;\n  }\n\n  switch (platform) {\n    case 'darwin':\n      formats.push('.icns');\n      if (pngToIcns) {\n        formats.push('.png');\n      }\n      if (icoToIcns) {\n        formats.push('.ico');\n      }\n      break;\n    case 'linux':\n      formats.push('.png');\n      if (icoToPng) {\n        formats.push('.ico');\n      }\n      if (icnsToPng) {\n        formats.push('.icns');\n      }\n      break;\n    case 'win32':\n      formats.push('.ico');\n      if (pngToIco) {\n        formats.push('.png');\n      }\n      if (icnsToIco) {\n        formats.push('.icns');\n      }\n      break;\n    default:\n      throw new Error(\n        `function allowedIconFormats error: Unknown platform ${platform}`,\n      );\n  }\n  return formats;\n}\n\nexport default {\n  isOSX,\n  isWindows,\n  downloadFile,\n  allowedIconFormats,\n};\n"]}